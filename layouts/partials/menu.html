<nav class="nav">
    <ul class="menu" id="menu">
        {{ if .Site.Params.activeInSection }}
            {{ .Scratch.Set "currentPage" (.Site.GetPage (printf `/%s` .Section)) }}
        {{ else }}
            {{ .Scratch.Set "currentPage" . }}
        {{ end }}
        {{ $currentPage := .Scratch.Get "currentPage" }}
        {{ $ctx := . }}
        {{ range .Site.Menus.main }}
            {{ if and (eq .Identifier "theme-switcher") $.Site.Params.enableDarkMode }}
                {{ if eq $.Site.Params.headerLayout "flex" }}
                    <!-- 添加的代码 -->
                    <script>
                        function searchFocus() {
                            setTimeout(function () { /* 延时对输入框聚焦 */
                                document.getElementById("aa-search-input").focus();
                            }, 100);
                            setTimeout(function () { /* 延时对输入框聚焦 */
                                document.getElementById("aa-search-input").focus();
                            }, 200);
                        };
                    </script>
                    <li class="menu-item">
                        <a id ="search-block" href="#ex1" rel="modal:open" onclick="searchFocus()">
                            <svg class="icon" xmlns="http://www.w3.org/2000/svg" height="511pt" viewBox="0 1 511 511.99999" width="511pt"><path d="m501.578125 478.699219c2.339844-9.824219-.265625-20.578125-7.84375-28.15625l-139.097656-139.101563-20.320313 20.316406 139.101563 139.101563c7.578125 7.578125 18.332031 10.183594 28.160156 7.839844zm0 0" fill="#72d8ff"/><path d="m398.335938 355.136719-42.765626 42.765625-43.695312-43.695313 42.765625-42.765625zm0 0" fill="#fff"/><path d="m226.453125 11.390625c-94.734375 11.792969-168.039063 92.589844-168.039063 190.515625s73.304688 178.71875 168.039063 190.511719c94.730469-11.792969 168.039063-92.585938 168.039063-190.511719s-73.308594-178.722656-168.039063-190.515625zm0 0" fill="#72d8ff"/><path d="m346.492188 201.90625c0 79.527344-64.472657 144-144 144-79.527344 0-144-64.472656-144-144 0-79.53125 64.472656-144 144-144 79.527343 0 144 64.46875 144 144zm0 0" fill="#fff"/><path d="m116.464844 317.375c24 17.914062 53.769531 28.53125 86.027344 28.53125 79.53125 0 144-64.46875 144-144 0-10.828125-1.214844-21.367188-3.484376-31.511719l-111.839843 111.84375-29.394531-29.394531-25.128907-25.125-71.667969 71.671875c3.382813 6.292969 7.238282 12.292969 11.488282 17.984375zm0 0" fill="#ff5d5d"/><path d="m500.808594 443.472656-129.941406-129.941406c52.015624-78.410156 43.507812-185.414062-25.539063-254.460938-78.761719-78.761718-206.910156-78.761718-285.671875 0-32.804688 32.804688-53.449219 76.246094-58.125 122.316407-4.613281 45.417969 6.371094 91.457031 30.921875 129.640625 2.988281 4.644531 9.175781 5.988281 13.820313 3.003906 4.648437-2.988281 5.988281-9.175781 3.003906-13.820312-45.917969-71.40625-35.605469-166.871094 24.519531-227 70.964844-70.960938 186.425781-70.960938 257.386719 0 70.960937 70.964843 70.960937 186.425781 0 257.386718-60.1875 60.191406-152.617188 70.855469-224.765625 25.933594-4.6875-2.914062-10.855469-1.484375-13.773438 3.207031-2.917969 4.6875-1.484375 10.851563 3.203125 13.773438 31.933594 19.878906 69.191406 30.382812 106.835938 30.382812 7.242187 0 14.503906-.390625 21.738281-1.175781 32.019531-3.476562 62.757813-14.707031 89.46875-32.347656l130.011719 130.007812c7.75 7.75 17.941406 11.621094 28.160156 11.621094 10.3125 0 20.660156-3.945312 28.539062-11.828125 15.6875-15.6875 15.78125-41.125.207032-56.699219zm-155.480469-98.734375c4.800781-4.800781 9.304687-9.789062 13.523437-14.9375l25.335938 25.335938-28.621094 28.621093-25.367187-25.367187c5.253906-4.28125 10.308593-8.832031 15.128906-13.652344zm141.132813 141.292969c-7.890626 7.894531-20.640626 7.984375-28.417969.203125l-88.335938-88.332031 28.621094-28.621094 88.335937 88.332031c7.777344 7.78125 7.6875 20.527344-.203124 28.417969zm0 0"/><path d="m73.539062 330.335938c-3.917968-3.890626-10.25-3.871094-14.144531.046874-3.890625 3.914063-3.871093 10.246094.042969 14.140626l.238281.238281c1.953125 1.9375 4.5 2.90625 7.050781 2.90625 2.570313 0 5.136719-.984375 7.09375-2.949219 3.890626-3.917969 3.871094-10.25-.042968-14.144531zm0 0"/><path d="m202.492188 355.902344c84.914062 0 154-69.082032 154-154 0-84.914063-69.085938-153.996094-154-153.996094-84.917969 0-154 69.082031-154 153.996094 0 84.917968 69.082031 154 154 154zm0-287.996094c73.886718 0 134 60.109375 134 134 0 73.886719-60.113282 134-134 134-48.371094 0-90.832032-25.765625-114.394532-64.285156l59.15625-59.15625 47.449219 47.449218c1.875 1.875 4.417969 2.929688 7.070313 2.929688 2.652343 0 5.195312-1.054688 7.070312-2.929688l74.53125-74.53125v3.023438c0 5.523438 4.476562 10 10 10s10-4.476562 10-10v-27.164062c0-5.523438-4.476562-10-10-10h-27.167969c-5.519531 0-10 4.476562-10 10 0 5.519531 4.480469 10 10 10h3.027344l-67.460937 67.457031-47.449219-47.449219c-1.875-1.875-4.421875-2.929688-7.070313-2.929688-2.652344 0-5.199218 1.054688-7.074218 2.929688l-61.613282 61.613281c-6.484375-15.71875-10.074218-32.925781-10.074218-50.957031 0-73.890625 60.113281-134 134-134zm0 0"/></svg>
                        </a>
                    </li>
                    <!-- 添加代码结束 -->
                    {{ $switcher := partial "components/dark-mode.html" $ctx }}
                    {{ with $switcher }}
                        <li class="menu-item">
                            {{ . }}
                        </li>
                    {{ end }}
                {{ end }}
            {{ else if eq .Identifier "lang-switcher" }}
                {{ if and $.Site.IsMultiLingual $.Site.Params.enableLangToggle }}
                    {{ if eq $.Site.Params.headerLayout "flex" }}
                        {{ $switcher := partial "components/multilingual.html" $ctx }}
                        {{ with $switcher }}
                            <li class="menu-item">
                                {{ . }}
                            </li>
                        {{ end }}
                    {{ end }}
                {{ end }}
            {{ else if eq .Identifier "search" }}
                {{ if and $.Site.Params.enableLunrSearch (eq $.Site.Params.headerLayout "flex") }}
                    {{- $iconName := (string .Post) -}}
                    <li class="menu-item search-item">
                        {{ partial "components/search.html" (dict "$" $ctx "iconName" $iconName) }}
                    </li>
                {{ end }}
            {{ else }}
                <li class="menu-item{{ if or ($currentPage.IsMenuCurrent "main" .) ($currentPage.HasMenuCurrent "main" .) }} active{{ end }}">
                    {{- $linkType := (string .Pre) -}}
                    <a href="{{ .URL }}"{{ if eq $linkType "external" }} target="_blank" rel="external noopener"{{ end }}>
                        {{- $iconName := (string .Post) -}}
                        {{- partial "utils/icon.html" (dict "$" $ "name" $iconName "class" .Identifier) -}}
                        {{- with .Name -}}
                            <span class="menu-item-name">{{ . }}</span>
                        {{- end -}}
                    </a>
                </li>
            {{ end }}
        {{ end }}
    </ul>
</nav>
